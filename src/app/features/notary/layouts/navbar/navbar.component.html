<!-- topbar.component.html -->
<header class="moj-topbar" dir="rtl">
  <nav class="moj-row">
    <!-- اليسار (في RTL هو اليمين بصريًا): شعار + عنوان + زر القائمة للموبايل -->
    <div class="moj-brand">
      <button class="hamburger p-button p-button-text p-button-rounded toggle"
              type="button" aria-label="فتح القائمة"
              (click)="mobileOpen = !mobileOpen">
        <i class="pi pi-bars"></i>
      </button>

      <img class="logo" src="assets/images/logoagd.png" alt="وزارة العدل">

    </div>

    <!-- الوسط: البحث (يتمدّد) -->
    <div class="moj-search">
      <span class="p-input-icon-left w-full">
        <i class="pi pi-search"></i>
        <input type="text"
               pInputText
               class="w-full"
               placeholder="بحث في النظام…"
               [(ngModel)]="q"
               (keyup.enter)="onSearch()"/>
      </span>
    </div>

    <!-- اليمين: إجراءات سريعة + بروفايل -->
    <div class="moj-actions">
      <!-- زر الإشعارات -->
<button
  type="button"
  class="notif-btn p-button p-button-text p-button-rounded"
  pButton
  pRipple
  aria-label="الإشعارات"
  (click)="notifMenu.toggle($event)"
>
  <i class="pi pi-bell" aria-hidden="true"></i>
  <span class="notif-badge" [class.is-hidden]="!(unreadCount > 0)">{{ unreadCount }}</span>
</button>

<p-menu #notifMenu [popup]="true" [model]="notifItems"></p-menu>


      <div class="profile" (click)="profileMenu.toggle($event)">
        <p-avatar image="assets/images/logoagd.png" shape="circle" size="large"></p-avatar>
        <div class="user-info">
          <span class="name">منصور علي</span>
          <small class="role">أمين شرعي معتمد</small>
        </div>
      </div>
      <p-menu #profileMenu [popup]="true" [model]="profileItems"></p-menu>
    </div>
  </nav>



  <!-- لوحة الموبايل (تُفتح بزر الهامبرجر) -->
  <div class="moj-mobile" [class.open]="mobileOpen" (click)="mobileOpen=false">
    <div class="panel" (click)="$event.stopPropagation()">
      <a class="panel-link" *ngFor="let l of mainLinks" [routerLink]="l.routerLink" (click)="mobileOpen=false">
        <i [class]="l.icon"></i><span>{{ l.label }}</span>
      </a>
      <div class="panel-divider"></div>
      <a class="panel-link" routerLink="/profile" (click)="mobileOpen=false"><i class="pi pi-user"></i><span>الملف الشخصي</span></a>
      <a class="panel-link" routerLink="/settings" (click)="mobileOpen=false"><i class="pi pi-cog"></i><span>الإعدادات</span></a>
    </div>
  </div>
</header>
